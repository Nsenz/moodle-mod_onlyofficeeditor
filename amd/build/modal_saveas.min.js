define ("mod_onlyofficeeditor/modal_saveas",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/templates"],function(a,b,c,d,e,f){var g=function(b,c){require(["core/notification"],function(d){require(["core/str"],function(e){var f=e.get_string(b,"onlyofficeeditor");a.when(f).done(function(a){d.addNotification({message:a,type:c})})})})},h={LOADING_ICON_CONTAINER:"[data-region=\"overlay-icon-container\"]",SECTION:".onlyofficeeditor-saveas-section",BUTTON:"#onlyofficeeditor-saveas-button",CONTAINER:".container"},i=function(a){a.find(h.LOADING_ICON_CONTAINER).removeClass("hidden")},j=function(a){a.find(h.LOADING_ICON_CONTAINER).addClass("hidden")},k=function(a){d.call(this,a);this.selectedSection=null;this.saveAsData=null;this.CMID=null;this.courseid=null};k.TYPE="mod_onlyofficeeditor-modal_saveas";k.prototype=Object.create(d.prototype);k.prototype.constructor=k;k.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);var b=this;this.getModal().on("click",h.SECTION,function(a){var c=b.selectedSection;if(null!==c){var d=b.getBody().find("#saveas-section-"+c)[0];d.classList.remove("onlyofficeeditor-saveas-section-selected")}var e=b.getFooter().find(h.BUTTON)[0];e.removeAttribute("disabled");a.target.classList.add("onlyofficeeditor-saveas-section-selected");b.selectedSection=parseInt(a.target.id.split("-")[2])}).bind(this);this.getModal().on("click",h.BUTTON,function(){b.saveAsData.section=b.selectedSection;a.ajax(M.cfg.wwwroot+"/mod/onlyofficeeditor/onlyofficeeditorapi.php?apiType=saveas&cmid=".concat(b.CMID),{type:"POST",dataType:"json",data:b.saveAsData}).done(function(){g("saveassuccess","success")}).fail(function(){g("saveaserror","error")}).always(function(){b.hide()})}).bind(this)};k.prototype.renderSections=function(b,c,d){var e=this;i(b);a.ajax(M.cfg.wwwroot+"/mod/onlyofficeeditor/onlyofficeeditorapi.php?apiType=sections&cmid=".concat(c),{type:"GET",dataType:"json",data:{courseid:d}}).done(function(a){var c=a.sections;f.render("mod_onlyofficeeditor/modal_saveas_sections_list",{sections:c}).then(function(a,c){var d=b.find(h.CONTAINER)[0];f.replaceNode(d,a,c)}).always(function(){j(b)})}).fail(function(){e.hide();g("saveaserror","error")})};k.prototype.show=function(){d.prototype.show.call(this);if(null!==this.selectedSection){this.selectedSection=null}var a=this.getFooter().find(h.BUTTON)[0];a.setAttribute("disabled","")};if(!e.get(k.TYPE)){e.register(k.TYPE,k,"mod_onlyofficeeditor/modal_saveas")}return k});
//# sourceMappingURL=modal_saveas.min.js.map
