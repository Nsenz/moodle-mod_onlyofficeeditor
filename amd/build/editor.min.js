define ("mod_onlyoffice/editor",["jquery"],function(a){var b=function(b){require(["core/notification"],function(c){require(["core/str"],function(d){var e=d.get_string(b,"onlyoffice");a.when(e).done(function(a){c.addNotification({message:a,type:"error"})})})})};a.urlParam=function(a){var b=new RegExp("[?&]"+a+"=([^&#]*)").exec(window.location.href);if(null===b){return null}return decodeURI(b[1])||0};var c=function(a,b){var c,d=a.indexOf("&actionType=");if(-1!=d){c=a.substring(0,d)+"&actionType="+encodeURIComponent(b.type)+"&actionData="+encodeURIComponent(b.data)}else{c=a+"&actionType="+encodeURIComponent(b.type)+"&actionData="+encodeURIComponent(b.data)}return c};return{init:function init(d,e){if("undefined"==typeof DocsAPI){b("docserverunreachable");return}var f=M.cfg.wwwroot+"/mod/onlyoffice/dsconfig.php";a.getJSON(f,{courseid:d,cmid:e,actionType:a.urlParam("actionType"),actionData:a.urlParam("actionData")}).done(function(d){var e=d.config;e.events={onMakeActionLink:function onMakeActionLink(a){var b=a.data.action;i.setActionLink(c(location.href,b))}};var f=function(){i.setUsers({users:h})},g=function(d){var e=d.data.message,f=d.data.emails,g=c(location.href,d.data.actionLink.action);a.ajax(M.cfg.wwwroot+"/mod/onlyoffice/onlyofficeeditorapi.php?apiType=mention&cmid="+a.urlParam("id"),{type:"POST",dataType:"json",data:{comment:e,emails:f,link:g},complete:function complete(a){if(200!=a.status){b("onmentionerror")}}})},h=d.userstomention;if(null!==h){e.events.onRequestUsers=f;e.events.onRequestSendNotify=g}var i=new DocsAPI.DocEditor("onlyoffice-editor",e)})}}});
//# sourceMappingURL=editor.min.js.map
