{"version":3,"sources":["../src/editor.js"],"names":["define","$","displayError","error","require","str","errorIsAvailable","get_string","when","done","localizedStr","text","addClass","createFullScreenButtons","enterFullScreenText","exitFullScreenText","navButton","editorContainer","localized","enterButton","document","createElement","enterIcon","className","appendChild","id","innerHTML","style","cssText","onclick","hide","getAttribute","click","show","prepend","exitButton","exitIcon","init","courseid","cmid","DocsAPI","ajaxUrl","M","cfg","wwwroot","getJSON","config","DocEditor"],"mappings":"AAsBAA,OAAM,+BAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,IACvBC,CAAAA,CAAY,CAAG,SAASC,CAAT,CAAgB,CAC/BC,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAgB,CAAGD,CAAG,CAACE,UAAJ,CAAeJ,CAAf,CAAsB,kBAAtB,CAAvB,CACAF,CAAC,CAACO,IAAF,CAAOF,CAAP,EAAyBG,IAAzB,CAA8B,SAASC,CAAT,CAAuB,CACjDT,CAAC,CAAC,0BAAD,CAAD,CAA8BU,IAA9B,CAAqCD,CAArC,CACAT,CAAC,CAAC,0BAAD,CAAD,CAA8BU,IAA9B,CAAmCD,CAAnC,EAAiDE,QAAjD,CAA0D,OAA1D,CACH,CAHD,CAIH,CANM,CAOV,CAT0B,CAWvBC,CAAuB,CAAG,UAAW,CACrCT,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,IAC5BS,CAAAA,CAAmB,CAAGT,CAAG,CAACE,UAAJ,CAAe,uBAAf,CAAwC,YAAxC,CADM,CAE5BQ,CAAkB,CAAGV,CAAG,CAACE,UAAJ,CAAe,sBAAf,CAAuC,YAAvC,CAFO,CAG5BS,CAAS,CAAGf,CAAC,CAAC,mBAAD,CAAD,CAAuB,CAAvB,CAHgB,CAI5BgB,CAAe,CAAGhB,CAAC,CAAC,uBAAD,CAAD,CAA2B,CAA3B,CAJU,CAMhCA,CAAC,CAACO,IAAF,CAAOM,CAAP,EAA4BL,IAA5B,CAAiC,SAASS,CAAT,CAAoB,CACjDJ,CAAmB,CAAGI,CAAtB,CADiD,GAE7CC,CAAAA,CAAW,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAF+B,CAG7CC,CAAS,CAAGF,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAHiC,CAIjDC,CAAS,CAACC,SAAV,CAAsB,yBAAtB,CACAJ,CAAW,CAACK,WAAZ,CAAwBF,CAAxB,EACAH,CAAW,CAACI,SAAZ,CAAwB,6BAAxB,CACAJ,CAAW,CAACM,EAAZ,CAAiB,4BAAjB,CACAN,CAAW,CAACO,SAAZ,EAAyBZ,CAAzB,CACAK,CAAW,CAACQ,KAAZ,CAAkBC,OAAlB,CAA4B,qDAA5B,CAEAT,CAAW,CAACU,OAAZ,CAAsB,UAAW,CAC7B5B,CAAC,CAAC,QAAD,CAAD,CAAY6B,IAAZ,GACA7B,CAAC,CAAC,QAAD,CAAD,CAAY6B,IAAZ,GACA,GAAgD,MAA5C,GAAAd,CAAS,CAACe,YAAV,CAAuB,eAAvB,CAAJ,CAAwD,CACpD9B,CAAC,CAAC,mBAAD,CAAD,CAAuB,CAAvB,EAA0B+B,KAA1B,EACH,CACDf,CAAe,CAACU,KAAhB,CAAsBC,OAAtB,wFAEA3B,CAAC,CAAC,6BAAD,CAAD,CAAiC6B,IAAjC,GACA7B,CAAC,CAAC,4BAAD,CAAD,CAAgCgC,IAAhC,EACH,CAVD,CAWAhC,CAAC,CAAC,qCAAD,CAAD,CAAyC,CAAzC,EAA4CiC,OAA5C,CAAoDf,CAApD,CACH,CAvBD,EAwBAlB,CAAC,CAACO,IAAF,CAAOO,CAAP,EAA2BN,IAA3B,CAAgC,SAASS,CAAT,CAAoB,CAChDH,CAAkB,CAAGG,CAArB,CADgD,GAE5CiB,CAAAA,CAAU,CAAGf,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAF+B,CAG5Ce,CAAQ,CAAGhB,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAHiC,CAIhDe,CAAQ,CAACb,SAAT,CAAqB,2BAArB,CACAY,CAAU,CAACX,WAAX,CAAuBY,CAAvB,EACAD,CAAU,CAACT,SAAX,EAAwBX,CAAxB,CACAoB,CAAU,CAACZ,SAAX,CAAuB,6BAAvB,CACAY,CAAU,CAACV,EAAX,CAAgB,2BAAhB,CAEAU,CAAU,CAACN,OAAX,CAAqB,UAAW,CAC5BZ,CAAe,CAACU,KAAhB,CAAsBC,OAAtB,CAAgC,EAAhC,CACA3B,CAAC,CAAC,QAAD,CAAD,CAAYgC,IAAZ,GACAhC,CAAC,CAAC,QAAD,CAAD,CAAYgC,IAAZ,GACAhC,CAAC,CAAC,6BAAD,CAAD,CAAiCgC,IAAjC,GACAhC,CAAC,CAAC,4BAAD,CAAD,CAAgC6B,IAAhC,EACH,CAND,CAOA7B,CAAC,CAAC,oBAAD,CAAD,CAAwB,CAAxB,EAA2BiC,OAA3B,CAAmCC,CAAnC,EACAlC,CAAC,CAAC,4BAAD,CAAD,CAAgC6B,IAAhC,EACH,CAnBD,CAoBH,CAlDM,CAmDV,CA/D0B,CAiE3B,MAAO,CACHO,IAAI,CAAE,cAASC,CAAT,CAAmBC,CAAnB,CAAyB,CAC3B,GAAuB,WAAnB,QAAOC,CAAAA,OAAX,CAAoC,CAChCtC,CAAY,CAAC,sBAAD,CAAZ,CACA,MACH,CACDW,CAAuB,GACvB,GAAI4B,CAAAA,CAAO,CAAGC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,oCAA9B,CACA3C,CAAC,CAAC4C,OAAF,CAAUJ,CAAV,CAAmB,CACfH,QAAQ,CAAEA,CADK,CAEfC,IAAI,CAAEA,CAFS,CAAnB,EAGG9B,IAHH,CAGQ,SAASqC,CAAT,CAAiB,CAErB,GAAIN,CAAAA,OAAO,CAACO,SAAZ,CAAsB,yBAAtB,CAAiDD,CAAjD,CACH,CAND,CAOH,CAfE,CAiBV,CAlFK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/* @package    mod_onlyofficeeditor\n * @copyright  2022 Ascensio System SIA <integration@onlyoffice.com>\n * @copyright  based on work by 2018 Olumuyiwa Taiwo <muyi.taiwo@logicexpertise.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery'], function($) {\n    var displayError = function(error) {\n        require(['core/str'], function(str) {\n            var errorIsAvailable = str.get_string(error, 'onlyofficeeditor');\n            $.when(errorIsAvailable).done(function(localizedStr) {\n                $(\"#onlyofficeeditor-editor\").text = localizedStr;\n                $(\"#onlyofficeeditor-editor\").text(localizedStr).addClass(\"error\");\n            });\n        });\n    };\n\n    var createFullScreenButtons = function() {\n        require(['core/str'], function(str) {\n            var enterFullScreenText = str.get_string('editorenterfullscreen', 'onlyoffice');\n            var exitFullScreenText = str.get_string('editorexitfullscreen', 'onlyoffice');\n            var navButton = $('nav .nav-link.btn')[0];\n            var editorContainer = $('.onlyoffice-container')[0];\n\n            $.when(enterFullScreenText).done(function(localized) {\n                enterFullScreenText = localized;\n                var enterButton = document.createElement('button');\n                var enterIcon = document.createElement('i');\n                enterIcon.className = 'icon fa fa-expand fa-fw';\n                enterButton.appendChild(enterIcon);\n                enterButton.className = 'onlyoffice-editor-fs-button';\n                enterButton.id = 'onlyoffice-enter-fs-button';\n                enterButton.innerHTML += enterFullScreenText;\n                enterButton.style.cssText = 'padding: 5px; margin-top: -5px; margin-right: 10px;';\n\n                enterButton.onclick = function() {\n                    $('header').hide();\n                    $('footer').hide();\n                    if (navButton.getAttribute('aria-expanded') === 'true') {\n                        $('nav .nav-link.btn')[0].click();\n                    }\n                    editorContainer.style.cssText = 'position: absolute; left: 0; right: 0; top: 0; ' +\n                        'padding: 0 16px 0 16px; z-index: 100;';\n                    $('#onlyoffice-enter-fs-button').hide();\n                    $('#onlyoffice-exit-fs-button').show();\n                };\n                $(\"#region-main-settings-menu .menubar\")[0].prepend(enterButton);\n            });\n            $.when(exitFullScreenText).done(function(localized) {\n                exitFullScreenText = localized;\n                var exitButton = document.createElement('button');\n                var exitIcon = document.createElement('i');\n                exitIcon.className = 'icon fa fa-compress fa-fw';\n                exitButton.appendChild(exitIcon);\n                exitButton.innerHTML += exitFullScreenText;\n                exitButton.className = 'onlyoffice-editor-fs-button';\n                exitButton.id = 'onlyoffice-exit-fs-button';\n\n                exitButton.onclick = function() {\n                    editorContainer.style.cssText = '';\n                    $('header').show();\n                    $('footer').show();\n                    $('#onlyoffice-enter-fs-button').show();\n                    $('#onlyoffice-exit-fs-button').hide();\n                };\n                $('.usernav .nav-item')[0].prepend(exitButton);\n                $('#onlyoffice-exit-fs-button').hide();\n            });\n        });\n    };\n\n    return {\n        init: function(courseid, cmid) {\n            if (typeof DocsAPI === \"undefined\") {\n                displayError('docserverunreachable');\n                return;\n            }\n            createFullScreenButtons();\n            var ajaxUrl = M.cfg.wwwroot + '/mod/onlyofficeeditor/dsconfig.php';\n            $.getJSON(ajaxUrl, {\n                courseid: courseid,\n                cmid: cmid\n            }).done(function(config) {\n                // eslint-disable-next-line no-undef\n                new DocsAPI.DocEditor(\"onlyofficeeditor-editor\", config);\n            });\n        }\n    };\n});\n"],"file":"editor.min.js"}